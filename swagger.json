{"openapi":"3.0.0","info":{"title":"Lago API","version":"1.0.0","description":"Lago 社区二手租售平台 API 文档"},"servers":[{"url":"http://localhost:3001","description":"开发环境"}],"components":{"schemas":{"Pagination":{"type":"object","properties":{"page":{"type":"integer","description":"当前页码"},"limit":{"type":"integer","description":"每页数量"},"total":{"type":"integer","description":"总记录数"},"totalPages":{"type":"integer","description":"总页数"}},"required":["page","limit","total","totalPages"]},"User":{"type":"object","properties":{"id":{"type":"string","description":"用户ID"},"nickname":{"type":"string","nullable":true,"description":"昵称"},"avatarUrl":{"type":"string","nullable":true,"description":"头像URL"},"role":{"type":"string","enum":["user","merchant","property","admin"],"description":"用户角色"},"phone":{"type":"string","nullable":true,"description":"手机号"},"isVerified":{"type":"boolean","description":"是否实名认证"},"creditScore":{"type":"integer","description":"信用积分"},"communityIds":{"type":"array","items":{"type":"string"},"description":"小区ID列表"}},"required":["id","role","isVerified","creditScore"]},"OperationStaff":{"type":"object","properties":{"id":{"type":"string","description":"运营人员ID"},"username":{"type":"string","description":"用户名"},"email":{"type":"string","description":"邮箱"},"role":{"type":"string","enum":["super_admin","audit_staff","service_staff","operation_staff","finance_staff"],"description":"运营角色"},"realName":{"type":"string","nullable":true,"description":"真实姓名"},"phone":{"type":"string","nullable":true,"description":"手机号"}},"required":["id","username","email","role"]},"LoginResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"token":{"type":"string","description":"JWT Token"},"user":{"$ref":"#/components/schemas/User"}},"required":["token","user"]}},"required":["success","data"]},"OperationLoginResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"token":{"type":"string","description":"JWT Token"},"staff":{"$ref":"#/components/schemas/OperationStaff"}},"required":["token","staff"]}},"required":["success","data"]},"WechatLoginRequest":{"type":"object","properties":{"code":{"type":"string","description":"微信登录code"}},"required":["code"]},"PhoneLoginRequest":{"type":"object","properties":{"phone":{"type":"string","description":"手机号"},"password":{"type":"string","description":"密码"}},"required":["phone","password"]},"PhoneRegisterRequest":{"type":"object","properties":{"phone":{"type":"string","description":"手机号"},"password":{"type":"string","description":"密码","minLength":6},"verifyCode":{"type":"string","nullable":true,"description":"验证码（可选）"}},"required":["phone","password"]},"OperationLoginRequest":{"type":"object","properties":{"username":{"type":"string","description":"用户名或邮箱"},"password":{"type":"string","description":"密码"},"verifyCode":{"type":"string","nullable":true,"description":"验证码（可选）"}},"required":["username","password"]},"UniversalLoginRequest":{"type":"object","properties":{"identifier":{"type":"string","description":"登录标识（手机号/邮箱/微信ID）"},"password":{"type":"string","description":"密码（可选，微信登录时不需要）"},"wechatOpenid":{"type":"string","description":"微信OpenID（可选，用于微信登录）"}},"required":["identifier 或 wechatOpenid"]},"ErrorResponse":{"type":"object","properties":{"success":{"type":"boolean","description":"请求是否成功","example":false},"error":{"type":"string","description":"错误信息"}},"required":["success","error"]},"SuccessResponse":{"type":"object","properties":{"success":{"type":"boolean","description":"请求是否成功","example":true},"data":{"type":"object","nullable":true,"description":"业务数据载体","additionalProperties":true}},"required":["success"]},"Product":{"type":"object","properties":{"id":{"type":"string","description":"商品ID"},"title":{"type":"string","description":"商品标题"},"description":{"type":"string","nullable":true,"description":"商品描述"},"category":{"type":"string","enum":["toys","gaming"],"description":"商品分类"},"type":{"type":"string","enum":["rent","sell","both"],"description":"交易类型"},"price":{"type":"string","format":"decimal","description":"价格"},"deposit":{"type":"string","format":"decimal","nullable":true,"description":"押金（租赁）"},"status":{"type":"string","enum":["pending","active","sold","rented","offline"],"description":"商品状态"},"images":{"type":"array","items":{"type":"string"},"description":"商品图片"},"location":{"type":"string","nullable":true,"description":"地理位置"},"isVerified":{"type":"boolean","description":"是否认证商品"},"viewCount":{"type":"integer","description":"浏览次数"},"likeCount":{"type":"integer","description":"收藏次数"},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}},"required":["id","title","category","type","price","status","images"]},"ProductApproveRequest":{"type":"object","properties":{"action":{"type":"string","enum":["approve","reject"],"description":"审核操作"},"reason":{"type":"string","nullable":true,"description":"拒绝原因（可选）"}},"required":["action"]},"ProductBatchApproveRequest":{"type":"object","properties":{"ids":{"type":"array","items":{"type":"string"},"description":"商品ID数组"},"action":{"type":"string","enum":["approve","reject"],"description":"审核操作"},"reason":{"type":"string","nullable":true,"description":"拒绝原因（可选）"}},"required":["ids","action"]},"Order":{"type":"object","properties":{"id":{"type":"string","description":"订单ID"},"type":{"type":"string","enum":["rent","sell"],"description":"订单类型"},"status":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"],"description":"订单状态"},"amount":{"type":"string","format":"decimal","description":"订单金额"},"deposit":{"type":"string","format":"decimal","nullable":true,"description":"押金（租赁）"},"startDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁开始日期"},"endDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁结束日期"},"deliveryType":{"type":"string","enum":["self_pickup","delivery","cabinet"],"description":"配送方式"},"deliveryAddress":{"type":"string","nullable":true,"description":"配送地址"},"remark":{"type":"string","nullable":true,"description":"备注"},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}},"required":["id","type","status","amount","deliveryType"]},"OrderStatusUpdateRequest":{"type":"object","properties":{"status":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"],"description":"订单状态"},"remark":{"type":"string","nullable":true,"description":"备注（可选）"}},"required":["status"]},"ChatMessage":{"type":"object","properties":{"id":{"type":"string","description":"消息ID"},"chatRoomId":{"type":"string","description":"所属聊天室ID"},"senderId":{"type":"string","description":"发送者用户ID"},"receiverId":{"type":"string","nullable":true,"description":"接收者用户ID"},"type":{"type":"string","enum":["text","image","system","product_card"],"description":"消息类型"},"content":{"type":"string","description":"消息内容"},"fileUrl":{"type":"string","nullable":true,"description":"附件URL（图片等）"},"productId":{"type":"string","nullable":true,"description":"关联商品ID"},"isRead":{"type":"boolean","description":"是否已读"},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"readAt":{"type":"string","format":"date-time","nullable":true,"description":"读取时间"},"sender":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"nickname":{"type":"string"},"avatarUrl":{"type":"string","nullable":true}}}},"required":["id","chatRoomId","senderId","type","content","isRead","createdAt"]},"ChatRoom":{"type":"object","properties":{"id":{"type":"string","description":"聊天室ID"},"productId":{"type":"string","nullable":true,"description":"关联商品ID"},"type":{"type":"string","enum":["private","group"],"description":"聊天室类型"},"isActive":{"type":"boolean","description":"是否有效"},"product":{"$ref":"#/components/schemas/Product","nullable":true},"members":{"type":"array","items":{"type":"object","properties":{"userId":{"type":"string"},"user":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"nickname":{"type":"string"},"avatarUrl":{"type":"string","nullable":true}}}}}},"messages":{"type":"array","items":{"$ref":"#/components/schemas/ChatMessage"}},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}},"required":["id","type","isActive","createdAt","updatedAt"]},"Community":{"type":"object","properties":{"id":{"type":"string","description":"小区ID"},"name":{"type":"string","description":"小区名称"},"location":{"type":"string","description":"地理位置（lat,lng）"},"address":{"type":"string","nullable":true,"description":"详细地址"},"verificationStatus":{"type":"string","enum":["pending","approved","rejected"],"description":"认证状态"},"images":{"type":"array","items":{"type":"string"},"description":"小区图片"},"description":{"type":"string","nullable":true,"description":"小区介绍"},"distance":{"type":"integer","nullable":true,"description":"距离（米）—仅附近搜索时出现"},"_count":{"type":"object","nullable":true,"properties":{"members":{"type":"integer"},"products":{"type":"integer"}}},"province":{"type":"object","nullable":true,"properties":{"name":{"type":"string"}}},"city":{"type":"object","nullable":true,"properties":{"name":{"type":"string"}}},"district":{"type":"object","nullable":true,"properties":{"name":{"type":"string"}}}},"required":["id","name","location","verificationStatus"]},"Province":{"type":"object","properties":{"id":{"type":"string"},"code":{"type":"string"},"name":{"type":"string"}},"required":["id","code","name"]},"City":{"type":"object","properties":{"id":{"type":"string"},"provinceId":{"type":"string"},"code":{"type":"string"},"name":{"type":"string"}},"required":["id","provinceId","code","name"]},"District":{"type":"object","properties":{"id":{"type":"string"},"cityId":{"type":"string"},"code":{"type":"string"},"name":{"type":"string"}},"required":["id","cityId","code","name"]},"UserStatusUpdateRequest":{"type":"object","properties":{"isActive":{"type":"boolean","nullable":true,"description":"是否激活"},"creditScore":{"type":"integer","nullable":true,"minimum":0,"maximum":1000,"description":"信用积分"}}}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT Token 认证，格式：Bearer {token}"}}},"paths":{"/api/auth/login":{"post":{"summary":"通用登录接口（支持手机号/邮箱/微信ID + 密码）","tags":["Auth","App"],"description":"支持多种登录方式：\n- 手机号 + 密码\n- 邮箱 + 密码\n- 微信ID + 密码\n- 微信OpenID（无需密码）\n如果账号不存在且提供了密码，会自动创建账号并登录\n","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UniversalLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"登录失败（密码错误等）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"账号已被禁用","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/wechat/login":{"post":{"summary":"微信登录（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WechatLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/phone/login":{"post":{"summary":"手机号登录（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PhoneLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/phone/register":{"post":{"summary":"手机号注册（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PhoneRegisterRequest"}}}},"responses":{"200":{"description":"注册成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"description":"注册失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/login":{"post":{"summary":"运营系统登录","tags":["Auth","Operation"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationLoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/me":{"get":{"summary":"获取当前用户信息（小程序端）","tags":["Auth","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/me":{"get":{"summary":"获取当前运营人员信息","tags":["Auth","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"staff":{"$ref":"#/components/schemas/OperationStaff"}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/logout":{"post":{"summary":"用户退出登录（C端）","tags":["Auth","App"],"security":[{"bearerAuth":[]}],"description":"退出登录后，JWT Token将被加入黑名单，无法继续使用","responses":{"200":{"description":"退出登录成功","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"message":{"type":"string"}}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/logout":{"post":{"summary":"运营系统退出登录","tags":["Auth","Operation"],"security":[{"bearerAuth":[]}],"description":"退出登录后，JWT Token将被加入黑名单，无法继续使用","responses":{"200":{"description":"退出登录成功","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"message":{"type":"string"}}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/chat/rooms":{"get":{"summary":"获取聊天室列表","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"rooms":{"type":"array","items":{"$ref":"#/components/schemas/ChatRoom"}}},"required":["rooms"]}}}]}}}}}},"post":{"summary":"创建聊天室","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"productId":{"type":"string","description":"商品ID（可选）"},"otherUserId":{"type":"string","description":"对方用户ID"}}}}}},"responses":{"200":{"description":"创建成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"room":{"$ref":"#/components/schemas/ChatRoom"}},"required":["room"]}}}]}}}}}}},"/api/chat/rooms/{id}":{"get":{"summary":"获取聊天室详情","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"room":{"$ref":"#/components/schemas/ChatRoom"}},"required":["room"]}}}]}}}}}}},"/api/chat/rooms/{id}/messages":{"get":{"summary":"获取聊天消息列表","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"},{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"50"},"description":"每页数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"messages":{"type":"array","items":{"$ref":"#/components/schemas/ChatMessage"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["messages","pagination"]}}}]}}}}}},"post":{"summary":"发送消息","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"content":{"type":"string","description":"消息内容"},"type":{"type":"string","enum":["text","image","product_card"],"default":"text"},"fileUrl":{"type":"string","description":"文件URL（图片等）"},"productId":{"type":"string","description":"商品ID（商品卡片）"}}}}}},"responses":{"200":{"description":"发送成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"$ref":"#/components/schemas/ChatMessage"}},"required":["message"]}}}]}}}}}}},"/api/communities/my":{"get":{"summary":"获取用户加入的小区","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"communities":{"type":"array","items":{"$ref":"#/components/schemas/Community"}}},"required":["communities"]}}}]}}}}}}},"/api/communities/nearby":{"get":{"summary":"获取附近小区（1公里内）","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"latitude","schema":{"type":"number"},"required":true,"description":"纬度"},{"in":"query","name":"longitude","schema":{"type":"number"},"required":true,"description":"经度"},{"in":"query","name":"radius","schema":{"type":"number","default":1000},"description":"搜索半径（米），默认1000米"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"communities":{"type":"array","items":{"$ref":"#/components/schemas/Community"}}},"required":["communities"]}}}]}}}}}}},"/api/communities/search":{"get":{"summary":"搜索小区","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词"},{"in":"query","name":"provinceId","schema":{"type":"string"},"description":"省份ID"},{"in":"query","name":"cityId","schema":{"type":"string"},"description":"城市ID"},{"in":"query","name":"districtId","schema":{"type":"string"},"description":"区县ID"},{"in":"query","name":"verificationStatus","schema":{"type":"string","enum":["pending","approved","rejected"]},"description":"认证状态"},{"in":"query","name":"page","schema":{"type":"string"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string"},"description":"每页数量"}],"responses":{"200":{"description":"搜索成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"communities":{"type":"array","items":{"$ref":"#/components/schemas/Community"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["communities","pagination"]}}}]}}}}}}},"/api/communities/{id}":{"get":{"summary":"获取小区详情","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"community":{"$ref":"#/components/schemas/Community"}},"required":["community"]}}}]}}}}}}},"/api/communities/{id}/join":{"post":{"summary":"加入小区","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"加入成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}}}}},"/api/communities/{id}/leave":{"post":{"summary":"退出小区","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"退出成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}}}}},"/api/communities/{id}/verify":{"post":{"summary":"申请小区认证","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"companyName":{"type":"string"},"contactName":{"type":"string"},"contactPhone":{"type":"string"},"licenseUrl":{"type":"string"},"proofUrl":{"type":"string"}}}}}},"responses":{"200":{"description":"申请成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}}}}},"/api/admin/communities":{"get":{"summary":"获取小区列表","tags":["AdminCommunities","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string"},"description":"每页数量"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词"},{"in":"query","name":"verificationStatus","schema":{"type":"string","enum":["pending","approved","rejected"]},"description":"认证状态"}],"responses":{"200":{"description":"成功获取小区列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"communities":{"type":"array","items":{"$ref":"#/components/schemas/Community"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["communities","pagination"]}}}]}}}}}}},"/api/admin/communities/verifications":{"get":{"summary":"获取小区认证申请列表","tags":["AdminCommunities","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","approved","rejected"]},"description":"审核状态"}],"responses":{"200":{"description":"成功获取认证申请列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"verifications":{"type":"array","items":{"type":"object","description":"认证申请详情（包含社区基础信息）","additionalProperties":true}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["verifications","pagination"]}}}]}}}}}}},"/api/admin/communities/{id}":{"get":{"summary":"获取小区详情","tags":["AdminCommunities","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"成功获取小区详情","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"community":{"$ref":"#/components/schemas/Community"}},"required":["community"]}}}]}}}}}}},"/api/admin/communities/{id}/approve":{"post":{"summary":"审批小区认证（通过）","tags":["AdminCommunities","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"审批成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"认证审批通过"}},"required":["message"]}}}]}}}}}}},"/api/admin/communities/{id}/reject":{"post":{"summary":"审批小区认证（拒绝）","tags":["AdminCommunities","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"reason":{"type":"string","description":"拒绝原因"}}}}}},"responses":{"200":{"description":"审批成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"认证审批已拒绝"}},"required":["message"]}}}]}}}}}}},"/api/admin/dashboard/stats":{"get":{"summary":"获取仪表盘核心指标","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"成功获取核心指标","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"gmv":{"type":"object","properties":{"today":{"type":"number","description":"今日GMV"},"week":{"type":"number","description":"本周GMV"},"month":{"type":"number","description":"本月GMV"},"total":{"type":"number","description":"累计GMV"}},"required":["today","week","month","total"]},"users":{"type":"object","properties":{"newToday":{"type":"integer","description":"今日新增用户"},"newWeek":{"type":"integer","description":"本周新增用户"},"activeToday":{"type":"integer","description":"今日活跃用户"},"total":{"type":"integer","description":"总用户数"},"active":{"type":"integer","description":"活跃用户数"}},"required":["newToday","newWeek","activeToday","total","active"]},"communities":{"type":"object","properties":{"active":{"type":"integer","description":"活跃小区数"},"new":{"type":"integer","description":"新增小区数"}},"required":["active","new"]},"orders":{"type":"object","properties":{"today":{"type":"integer","description":"今日订单数"},"pending":{"type":"integer","description":"待处理订单数"}},"required":["today","pending"]},"pending":{"type":"object","properties":{"products":{"type":"integer","description":"待审核商品数"},"approvals":{"type":"integer","description":"待审核入驻数"},"complaints":{"type":"integer","description":"待处理投诉数"}},"required":["products","approvals","complaints"]}},"required":["gmv","users","communities","orders","pending"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/dashboard/trends":{"get":{"summary":"获取趋势数据","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"period","schema":{"type":"string","enum":["7d","30d","90d"],"default":"7d"},"description":"时间周期"}],"responses":{"200":{"description":"成功获取趋势数据","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"gmv":{"type":"array","items":{"type":"object","properties":{"date":{"type":"string","format":"date"},"value":{"type":"number"}}}},"users":{"type":"array","items":{"type":"object","properties":{"date":{"type":"string","format":"date"},"value":{"type":"integer"}}}}},"required":["gmv","users"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/dashboard/pending":{"get":{"summary":"获取待处理事项","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"成功获取待处理事项","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"approvals":{"type":"array","items":{"type":"object"},"description":"待审核入驻申请（待实现）"},"complaints":{"type":"array","items":{"type":"object"},"description":"待处理投诉（待实现）"}},"required":["products","approvals","complaints"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/orders":{"get":{"summary":"获取订单列表（小程序端）","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"]},"description":"订单状态"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell"]},"description":"订单类型"},{"in":"query","name":"role","schema":{"type":"string","enum":["buyer","seller"],"default":"buyer"},"description":"角色（买家/卖家）"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["orders","pagination"]}}}]}}}}}},"post":{"summary":"创建订单","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"productId":{"type":"string","description":"商品ID"},"type":{"type":"string","enum":["rent","sell"],"description":"订单类型"},"startDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁开始时间（租赁订单必填）"},"endDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁结束时间（租赁订单必填）"},"deliveryType":{"type":"string","enum":["self_pickup","delivery","cabinet"],"description":"配送方式"},"deliveryAddress":{"type":"string","nullable":true,"description":"配送地址"},"remark":{"type":"string","nullable":true,"description":"备注信息"}},"required":["productId","type"]}}}},"responses":{"200":{"description":"创建成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"order":{"allOf":[{"$ref":"#/components/schemas/Order"},{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"},"buyer":{"$ref":"#/components/schemas/User"},"seller":{"$ref":"#/components/schemas/User"},"depositRecord":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"amount":{"type":"string","format":"decimal"},"refundStatus":{"type":"string","enum":["pending","refunded","forfeited"]},"refundedAt":{"type":"string","format":"date-time","nullable":true}}}}}]}},"required":["order"]}}}]}}}}}}},"/api/orders/{id}":{"get":{"summary":"获取订单详情","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"order":{"allOf":[{"$ref":"#/components/schemas/Order"},{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"},"buyer":{"$ref":"#/components/schemas/User"},"seller":{"$ref":"#/components/schemas/User"},"depositRecord":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"amount":{"type":"string","format":"decimal"},"refundStatus":{"type":"string","enum":["pending","refunded","forfeited"]},"refundedAt":{"type":"string","format":"date-time","nullable":true}}}}}]}},"required":["order"]}}}]}}}}}}},"/api/orders/{id}/status":{"put":{"summary":"更新订单状态","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["paid","confirmed","completed","cancelled"]}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"订单状态已更新"}},"required":["message"]}}}]}}}}}}},"/api/orders/{id}/cancel":{"post":{"summary":"取消订单","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"取消成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"订单已取消"}},"required":["message"]}}}]}}}}}}},"/api/admin/orders":{"get":{"summary":"获取订单列表","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"]},"description":"订单状态"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell"]},"description":"订单类型"},{"in":"query","name":"buyerId","schema":{"type":"string"},"description":"买家ID"},{"in":"query","name":"sellerId","schema":{"type":"string"},"description":"卖家ID"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（订单ID或商品标题）"}],"responses":{"200":{"description":"成功获取订单列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["orders","pagination"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/orders/{id}":{"get":{"summary":"获取订单详情","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"成功获取订单详情","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"order":{"allOf":[{"$ref":"#/components/schemas/Order"},{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"},"buyer":{"$ref":"#/components/schemas/User"},"seller":{"$ref":"#/components/schemas/User"},"depositRecord":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"amount":{"type":"string","format":"decimal"},"refundStatus":{"type":"string","enum":["pending","refunded","forfeited"]},"refundedAt":{"type":"string","format":"date-time","nullable":true}}}}}]}},"required":["order"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"订单不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/orders/{id}/status":{"put":{"summary":"更新订单状态","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderStatusUpdateRequest"}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"订单不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products":{"get":{"summary":"获取商品列表（小程序端）","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"category","schema":{"type":"string","enum":["toys","gaming"]},"description":"商品分类"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell","both"]},"description":"交易类型"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词"},{"in":"query","name":"communityId","schema":{"type":"string"},"description":"小区ID"},{"in":"query","name":"sortBy","schema":{"type":"string","enum":["createdAt","price","viewCount","likeCount"],"default":"createdAt"},"description":"排序字段"},{"in":"query","name":"sortOrder","schema":{"type":"string","enum":["asc","desc"],"default":"desc"},"description":"排序方向"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["products","pagination"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"summary":"创建商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string","description":"商品标题"},"description":{"type":"string","nullable":true,"description":"商品描述"},"category":{"type":"string","enum":["toys","gaming"],"description":"商品分类"},"type":{"type":"string","enum":["rent","sell","both"],"description":"交易类型"},"price":{"type":"number","format":"float","description":"价格"},"deposit":{"type":"number","format":"float","nullable":true,"description":"押金（租赁）"},"images":{"type":"array","description":"商品图片","items":{"type":"string"}},"communityId":{"type":"string","nullable":true,"description":"所属小区ID"},"location":{"type":"string","nullable":true,"description":"地理位置描述"}},"required":["title","category","type","price"]}}}},"responses":{"200":{"description":"创建成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}},"required":["product"]}}}]}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/recommended":{"get":{"summary":"获取推荐商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"limit","schema":{"type":"string","default":"10"},"description":"返回数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}}},"required":["products"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/hot":{"get":{"summary":"获取热门商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"limit","schema":{"type":"string","default":"10"},"description":"返回数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}}},"required":["products"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}":{"get":{"summary":"获取商品详情","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}},"required":["product"]}}}]}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"summary":"更新商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string","description":"商品标题"},"description":{"type":"string","nullable":true,"description":"商品描述"},"category":{"type":"string","enum":["toys","gaming"],"description":"商品分类"},"type":{"type":"string","enum":["rent","sell","both"],"description":"交易类型"},"price":{"type":"number","format":"float","description":"价格"},"deposit":{"type":"number","format":"float","nullable":true,"description":"押金（租赁）"},"images":{"type":"array","description":"商品图片","items":{"type":"string"}},"status":{"type":"string","enum":["pending","active","sold","rented","offline"],"description":"商品状态"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}},"required":["product"]}}}]}}}},"403":{"description":"无权限","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"summary":"删除商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"商品已删除"}},"required":["message"]}}}]}}}},"403":{"description":"无权限","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}/like":{"post":{"summary":"收藏商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"收藏成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"收藏成功"}},"required":["message"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}/unlike":{"post":{"summary":"取消收藏商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"取消收藏成功","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"message":{"type":"string","example":"取消收藏成功"}},"required":["message"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products":{"get":{"summary":"获取商品列表","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","active","sold","rented","offline"]},"description":"商品状态"},{"in":"query","name":"category","schema":{"type":"string","enum":["toys","gaming"]},"description":"商品分类"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（商品标题或描述）"},{"in":"query","name":"ownerId","schema":{"type":"string"},"description":"卖家ID"}],"responses":{"200":{"description":"成功获取商品列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["products","pagination"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/{id}":{"get":{"summary":"获取商品详情","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"成功获取商品详情","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}},"required":["product"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/{id}/approve":{"post":{"summary":"审核商品","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductApproveRequest"}}}},"responses":{"200":{"description":"审核成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误或商品状态不正确","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证或权限不足","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"权限不足（需要审核专员或超级管理员）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/batch-approve":{"post":{"summary":"批量审核商品","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductBatchApproveRequest"}}}},"responses":{"200":{"description":"批量审核成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证或权限不足","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"权限不足（需要审核专员或超级管理员）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/regions/provinces":{"get":{"summary":"获取所有省份","tags":["Regions"],"responses":{"200":{"description":"成功获取省份列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"provinces":{"type":"array","items":{"$ref":"#/components/schemas/Province"}}},"required":["provinces"]}}}]}}}}}}},"/api/regions/cities":{"get":{"summary":"获取指定省份的城市列表","tags":["Regions"],"parameters":[{"in":"query","name":"provinceId","schema":{"type":"string"},"required":true,"description":"省份ID"}],"responses":{"200":{"description":"成功获取城市列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"cities":{"type":"array","items":{"$ref":"#/components/schemas/City"}}},"required":["cities"]}}}]}}}}}}},"/api/regions/districts":{"get":{"summary":"获取指定城市的区县列表","tags":["Regions"],"parameters":[{"in":"query","name":"cityId","schema":{"type":"string"},"required":true,"description":"城市ID"}],"responses":{"200":{"description":"成功获取区县列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"districts":{"type":"array","items":{"$ref":"#/components/schemas/District"}}},"required":["districts"]}}}]}}}}}}},"/api/regions/location":{"get":{"summary":"根据经纬度获取省市区信息（逆地理编码）","tags":["Regions"],"parameters":[{"in":"query","name":"lat","schema":{"type":"number"},"required":true},{"in":"query","name":"lng","schema":{"type":"number"},"required":true}],"responses":{"200":{"description":"成功获取省市区信息","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"province":{"$ref":"#/components/schemas/Province","nullable":true},"city":{"$ref":"#/components/schemas/City","nullable":true},"district":{"$ref":"#/components/schemas/District","nullable":true},"message":{"type":"string","nullable":true}}}}}]}}}}}}},"/api/share":{"post":{"summary":"获取分享数据","tags":["Share","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","enum":["appMessage","timeline"],"description":"分享类型"},"path":{"type":"string","description":"当前页面路径"},"options":{"type":"object","description":"额外选项"}}}}}},"responses":{"200":{"description":"分享数据","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"title":{"type":"string"},"desc":{"type":"string"},"path":{"type":"string"},"imageUrl":{"type":"string"}},"required":["title","desc","path","imageUrl"]}}}]}}}}}}},"/api/users/profile":{"get":{"summary":"获取用户信息","tags":["Users","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}}}},"put":{"summary":"更新用户信息","tags":["Users","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"nickname":{"type":"string"},"avatarUrl":{"type":"string"},"phone":{"type":"string"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}}}}},"/api/users/products":{"get":{"summary":"获取用户发布的商品","tags":["Users","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","active","sold","rented","offline"]},"description":"商品状态"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}}},"/api/users/orders":{"get":{"summary":"获取用户的订单（作为买家或卖家）","tags":["Users","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"role","schema":{"type":"string","enum":["buyer","seller"],"default":"buyer"},"description":"角色"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}}},"/api/admin/users":{"get":{"summary":"获取用户列表","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"role","schema":{"type":"string","enum":["user","merchant","property","admin"]},"description":"用户角色"},{"in":"query","name":"status","schema":{"type":"string","enum":["active","inactive"]},"description":"用户状态"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（昵称/手机号/邮箱）"}],"responses":{"200":{"description":"成功获取用户列表","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"users":{"type":"array","items":{"$ref":"#/components/schemas/User"}},"_count":{"type":"object","nullable":true,"additionalProperties":{"type":"number"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["users","pagination"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/users/{id}":{"get":{"summary":"获取用户详情","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"用户ID"}],"responses":{"200":{"description":"成功获取用户详情","content":{"application/json":{"schema":{"allOf":[{"$ref":"#/components/schemas/SuccessResponse"},{"type":"object","required":["data"],"properties":{"data":{"type":"object","properties":{"user":{"allOf":[{"$ref":"#/components/schemas/User"},{"type":"object","properties":{"wechatOpenid":{"type":"string","nullable":true,"description":"微信OpenID"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}}}]},"products":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"status":{"type":"string"},"price":{"type":"string","format":"decimal"},"createdAt":{"type":"string","format":"date-time"}}}},"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}}},"required":["user"]}}}]}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"用户不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/users/{id}/status":{"put":{"summary":"更新用户状态","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"用户ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserStatusUpdateRequest"}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"用户不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}}},"tags":[{"name":"Auth","description":"用户认证相关接口"},{"name":"Chat","description":"小程序端聊天相关接口"},{"name":"Communities","description":"小程序端社区相关接口"},{"name":"AdminCommunities","description":"运营系统小区管理相关接口"},{"name":"AdminDashboard","description":"运营系统仪表盘相关接口"},{"name":"Orders","description":"小程序端订单相关接口"},{"name":"AdminOrders","description":"运营系统订单管理相关接口"},{"name":"Products","description":"小程序端商品相关接口"},{"name":"AdminProducts","description":"运营系统商品管理相关接口"},{"name":"Share","description":"分享相关接口"},{"name":"Users","description":"小程序端用户相关接口"},{"name":"AdminUsers","description":"运营系统用户管理相关接口"}]}