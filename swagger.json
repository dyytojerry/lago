{"openapi":"3.0.0","info":{"title":"Lago API","version":"1.0.0","description":"Lago 社区二手租售平台 API 文档"},"servers":[{"url":"http://192.168.163.130:3001","description":"开发环境"}],"components":{"schemas":{"Pagination":{"type":"object","properties":{"page":{"type":"integer","description":"当前页码"},"limit":{"type":"integer","description":"每页数量"},"total":{"type":"integer","description":"总记录数"},"totalPages":{"type":"integer","description":"总页数"}},"required":["page","limit","total","totalPages"]},"User":{"type":"object","properties":{"id":{"type":"string","description":"用户ID"},"nickname":{"type":"string","nullable":true,"description":"昵称"},"avatarUrl":{"type":"string","nullable":true,"description":"头像URL"},"role":{"type":"string","enum":["user","merchant","property","admin"],"description":"用户角色"},"phone":{"type":"string","nullable":true,"description":"手机号"},"isVerified":{"type":"boolean","description":"是否实名认证"},"creditScore":{"type":"integer","description":"信用积分"},"communityIds":{"type":"array","items":{"type":"string"},"description":"小区ID列表"}},"required":["id","role","isVerified","creditScore"]},"OperationStaff":{"type":"object","properties":{"id":{"type":"string","description":"运营人员ID"},"username":{"type":"string","description":"用户名"},"email":{"type":"string","description":"邮箱"},"role":{"type":"string","enum":["super_admin","audit_staff","service_staff","operation_staff","finance_staff"],"description":"运营角色"},"realName":{"type":"string","nullable":true,"description":"真实姓名"},"phone":{"type":"string","nullable":true,"description":"手机号"}},"required":["id","username","email","role"]},"LoginResponse":{"type":"object","properties":{"token":{"type":"string","description":"JWT Token"},"user":{"$ref":"#/components/schemas/User"}},"required":["token","user"]},"OperationLoginResponse":{"type":"object","properties":{"token":{"type":"string","description":"JWT Token"},"staff":{"$ref":"#/components/schemas/OperationStaff"}},"required":["token","staff"]},"WechatLoginRequest":{"type":"object","properties":{"code":{"type":"string","description":"微信登录code"}},"required":["code"]},"PhoneLoginRequest":{"type":"object","properties":{"phone":{"type":"string","description":"手机号"},"password":{"type":"string","description":"密码"}},"required":["phone","password"]},"PhoneRegisterRequest":{"type":"object","properties":{"phone":{"type":"string","description":"手机号"},"password":{"type":"string","description":"密码","minLength":6},"verifyCode":{"type":"string","nullable":true,"description":"验证码（可选）"}},"required":["phone","password"]},"OperationLoginRequest":{"type":"object","properties":{"username":{"type":"string","description":"用户名或邮箱"},"password":{"type":"string","description":"密码"},"verifyCode":{"type":"string","nullable":true,"description":"验证码（可选）"}},"required":["username","password"]},"UniversalLoginRequest":{"type":"object","properties":{"identifier":{"type":"string","description":"登录标识（手机号/邮箱/微信ID）"},"password":{"type":"string","description":"密码（可选，微信登录时不需要）"},"wechatOpenid":{"type":"string","description":"微信OpenID（可选，用于微信登录）"}},"required":["identifier 或 wechatOpenid"]},"ErrorResponse":{"type":"object","properties":{"error":{"type":"string","description":"错误信息"}},"required":["error"]},"SuccessResponse":{"type":"object","properties":{"success":{"type":"boolean","description":"是否成功"},"message":{"type":"string","nullable":true,"description":"提示信息"}},"required":["success"]},"Product":{"type":"object","properties":{"id":{"type":"string","description":"商品ID"},"title":{"type":"string","description":"商品标题"},"description":{"type":"string","nullable":true,"description":"商品描述"},"category":{"type":"string","enum":["toys","gaming"],"description":"商品分类"},"type":{"type":"string","enum":["rent","sell","both"],"description":"交易类型"},"price":{"type":"string","format":"decimal","description":"价格"},"deposit":{"type":"string","format":"decimal","nullable":true,"description":"押金（租赁）"},"status":{"type":"string","enum":["pending","active","sold","rented","offline"],"description":"商品状态"},"images":{"type":"array","items":{"type":"string"},"description":"商品图片"},"location":{"type":"string","nullable":true,"description":"地理位置"},"isVerified":{"type":"boolean","description":"是否认证商品"},"viewCount":{"type":"integer","description":"浏览次数"},"likeCount":{"type":"integer","description":"收藏次数"},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}},"required":["id","title","category","type","price","status","images"]},"ProductListResponse":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["products","pagination"]},"ProductDetailResponse":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}},"required":["product"]},"ProductApproveRequest":{"type":"object","properties":{"action":{"type":"string","enum":["approve","reject"],"description":"审核操作"},"reason":{"type":"string","nullable":true,"description":"拒绝原因（可选）"}},"required":["action"]},"ProductBatchApproveRequest":{"type":"object","properties":{"ids":{"type":"array","items":{"type":"string"},"description":"商品ID数组"},"action":{"type":"string","enum":["approve","reject"],"description":"审核操作"},"reason":{"type":"string","nullable":true,"description":"拒绝原因（可选）"}},"required":["ids","action"]},"Order":{"type":"object","properties":{"id":{"type":"string","description":"订单ID"},"type":{"type":"string","enum":["rent","sell"],"description":"订单类型"},"status":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"],"description":"订单状态"},"amount":{"type":"string","format":"decimal","description":"订单金额"},"deposit":{"type":"string","format":"decimal","nullable":true,"description":"押金（租赁）"},"startDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁开始日期"},"endDate":{"type":"string","format":"date-time","nullable":true,"description":"租赁结束日期"},"deliveryType":{"type":"string","enum":["self_pickup","delivery","cabinet"],"description":"配送方式"},"deliveryAddress":{"type":"string","nullable":true,"description":"配送地址"},"remark":{"type":"string","nullable":true,"description":"备注"},"createdAt":{"type":"string","format":"date-time","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}},"required":["id","type","status","amount","deliveryType"]},"OrderListResponse":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["orders","pagination"]},"OrderDetailResponse":{"type":"object","properties":{"order":{"allOf":[{"$ref":"#/components/schemas/Order"},{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"},"buyer":{"$ref":"#/components/schemas/User"},"seller":{"$ref":"#/components/schemas/User"},"depositRecord":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"amount":{"type":"string","format":"decimal"},"refundStatus":{"type":"string","enum":["pending","refunded","forfeited"]},"refundedAt":{"type":"string","format":"date-time","nullable":true}}}}}]}},"required":["order"]},"OrderStatusUpdateRequest":{"type":"object","properties":{"status":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"],"description":"订单状态"},"remark":{"type":"string","nullable":true,"description":"备注（可选）"}},"required":["status"]},"UserListResponse":{"type":"object","properties":{"users":{"type":"array","items":{"$ref":"#/components/schemas/User"}},"pagination":{"$ref":"#/components/schemas/Pagination"}},"required":["users","pagination"]},"UserDetailResponse":{"type":"object","properties":{"user":{"allOf":[{"$ref":"#/components/schemas/User"},{"type":"object","properties":{"wechatOpenid":{"type":"string","nullable":true,"description":"微信OpenID"},"updatedAt":{"type":"string","format":"date-time","description":"更新时间"}}}]},"products":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"status":{"type":"string"},"price":{"type":"string","format":"decimal"},"createdAt":{"type":"string","format":"date-time"}}}},"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}}},"required":["user"]},"UserStatusUpdateRequest":{"type":"object","properties":{"isActive":{"type":"boolean","nullable":true,"description":"是否激活"},"creditScore":{"type":"integer","nullable":true,"minimum":0,"maximum":1000,"description":"信用积分"}}},"DashboardStats":{"type":"object","properties":{"gmv":{"type":"object","properties":{"today":{"type":"number","description":"今日GMV"},"week":{"type":"number","description":"本周GMV"},"month":{"type":"number","description":"本月GMV"},"total":{"type":"number","description":"累计GMV"}},"required":["today","week","month","total"]},"users":{"type":"object","properties":{"newToday":{"type":"integer","description":"今日新增用户"},"newWeek":{"type":"integer","description":"本周新增用户"},"activeToday":{"type":"integer","description":"今日活跃用户"},"total":{"type":"integer","description":"总用户数"},"active":{"type":"integer","description":"活跃用户数"}},"required":["newToday","newWeek","activeToday","total","active"]},"communities":{"type":"object","properties":{"active":{"type":"integer","description":"活跃小区数"},"new":{"type":"integer","description":"新增小区数"}},"required":["active","new"]},"orders":{"type":"object","properties":{"today":{"type":"integer","description":"今日订单数"},"pending":{"type":"integer","description":"待处理订单数"}},"required":["today","pending"]},"pending":{"type":"object","properties":{"products":{"type":"integer","description":"待审核商品数"},"approvals":{"type":"integer","description":"待审核入驻数"},"complaints":{"type":"integer","description":"待处理投诉数"}},"required":["products","approvals","complaints"]}},"required":["gmv","users","communities","orders","pending"]},"DashboardTrends":{"type":"object","properties":{"gmv":{"type":"array","items":{"type":"object","properties":{"date":{"type":"string","format":"date"},"value":{"type":"number"}}}},"users":{"type":"array","items":{"type":"object","properties":{"date":{"type":"string","format":"date"},"value":{"type":"integer"}}}}},"required":["gmv","users"]},"PendingItems":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"approvals":{"type":"array","items":{"type":"object"},"description":"待审核入驻申请（待实现）"},"complaints":{"type":"array","items":{"type":"object"},"description":"待处理投诉（待实现）"}},"required":["products","approvals","complaints"]}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT Token 认证，格式：Bearer {token}"}}},"paths":{"/api/auth/login":{"post":{"summary":"通用登录接口（支持手机号/邮箱/微信ID + 密码）","tags":["Auth","App"],"description":"支持多种登录方式：\n- 手机号 + 密码\n- 邮箱 + 密码\n- 微信ID + 密码\n- 微信OpenID（无需密码）\n如果账号不存在且提供了密码，会自动创建账号并登录\n","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UniversalLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"登录失败（密码错误等）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"账号已被禁用","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/wechat/login":{"post":{"summary":"微信登录（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WechatLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/phone/login":{"post":{"summary":"手机号登录（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PhoneLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/phone/register":{"post":{"summary":"手机号注册（小程序端）","tags":["Auth","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PhoneRegisterRequest"}}}},"responses":{"201":{"description":"注册成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"description":"注册失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/login":{"post":{"summary":"运营系统登录","tags":["Auth","Operation"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationLoginRequest"}}}},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationLoginResponse"}}}},"401":{"description":"登录失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/me":{"get":{"summary":"获取当前用户信息（小程序端）","tags":["Auth","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/me":{"get":{"summary":"获取当前运营人员信息","tags":["Auth","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"staff":{"$ref":"#/components/schemas/OperationStaff"}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/logout":{"post":{"summary":"用户退出登录（C端）","tags":["Auth","App"],"security":[{"bearerAuth":[]}],"description":"退出登录后，JWT Token将被加入黑名单，无法继续使用","responses":{"200":{"description":"退出登录成功","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"message":{"type":"string"}}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/auth/operation/logout":{"post":{"summary":"运营系统退出登录","tags":["Auth","Operation"],"security":[{"bearerAuth":[]}],"description":"退出登录后，JWT Token将被加入黑名单，无法继续使用","responses":{"200":{"description":"退出登录成功","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"message":{"type":"string"}}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/chat/rooms":{"get":{"summary":"获取聊天室列表","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"rooms":{"type":"array","items":{"$ref":"#/components/schemas/ChatRoom"}}}}}}}}},"post":{"summary":"创建聊天室","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"productId":{"type":"string","description":"商品ID（可选）"},"otherUserId":{"type":"string","description":"对方用户ID"}}}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"room":{"$ref":"#/components/schemas/ChatRoom"}}}}}}}}},"/api/chat/rooms/{id}":{"get":{"summary":"获取聊天室详情","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"room":{"$ref":"#/components/schemas/ChatRoom"}}}}}}}}},"/api/chat/rooms/{id}/messages":{"get":{"summary":"获取聊天消息列表","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"},{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"50"},"description":"每页数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"messages":{"type":"array","items":{"$ref":"#/components/schemas/ChatMessage"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}},"post":{"summary":"发送消息","tags":["Chat","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"聊天室ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"content":{"type":"string","description":"消息内容"},"type":{"type":"string","enum":["text","image","product_card"],"default":"text"},"fileUrl":{"type":"string","description":"文件URL（图片等）"},"productId":{"type":"string","description":"商品ID（商品卡片）"}}}}}},"responses":{"201":{"description":"发送成功","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"$ref":"#/components/schemas/ChatMessage"}}}}}}}}},"/api/communities/nearby":{"get":{"summary":"获取附近小区","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"latitude","schema":{"type":"number"},"description":"纬度"},{"in":"query","name":"longitude","schema":{"type":"number"},"description":"经度"},{"in":"query","name":"radius","schema":{"type":"number","default":5000},"description":"搜索半径（米）"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"communities":{"type":"array","items":{"$ref":"#/components/schemas/Community"}}}}}}}}}},"/api/communities/{id}":{"get":{"summary":"获取小区详情","tags":["Communities","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"小区ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"community":{"$ref":"#/components/schemas/Community"}}}}}}}}},"/api/admin/dashboard/stats":{"get":{"summary":"获取仪表盘核心指标","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"成功获取核心指标","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardStats"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/dashboard/trends":{"get":{"summary":"获取趋势数据","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"period","schema":{"type":"string","enum":["7d","30d","90d"],"default":"7d"},"description":"时间周期"}],"responses":{"200":{"description":"成功获取趋势数据","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardTrends"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/dashboard/pending":{"get":{"summary":"获取待处理事项","tags":["AdminDashboard","Operation"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"成功获取待处理事项","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PendingItems"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/orders":{"get":{"summary":"获取订单列表（小程序端）","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"]},"description":"订单状态"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell"]},"description":"订单类型"},{"in":"query","name":"role","schema":{"type":"string","enum":["buyer","seller"],"default":"buyer"},"description":"角色（买家/卖家）"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}},"post":{"summary":"创建订单","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrderRequest"}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"order":{"$ref":"#/components/schemas/Order"}}}}}}}}},"/api/orders/{id}":{"get":{"summary":"获取订单详情","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"order":{"$ref":"#/components/schemas/Order"}}}}}}}}},"/api/orders/{id}/status":{"put":{"summary":"更新订单状态","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["paid","confirmed","completed","cancelled"]}}}}}},"responses":{"200":{"description":"更新成功"}}}},"/api/orders/{id}/cancel":{"post":{"summary":"取消订单","tags":["Orders","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"取消成功"}}}},"/api/admin/orders":{"get":{"summary":"获取订单列表","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","paid","confirmed","completed","cancelled","refunded"]},"description":"订单状态"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell"]},"description":"订单类型"},{"in":"query","name":"buyerId","schema":{"type":"string"},"description":"买家ID"},{"in":"query","name":"sellerId","schema":{"type":"string"},"description":"卖家ID"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（订单ID或商品标题）"}],"responses":{"200":{"description":"成功获取订单列表","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderListResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/orders/{id}":{"get":{"summary":"获取订单详情","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"responses":{"200":{"description":"成功获取订单详情","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderDetailResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"订单不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/orders/{id}/status":{"put":{"summary":"更新订单状态","tags":["AdminOrders","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"订单ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderStatusUpdateRequest"}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"订单不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products":{"get":{"summary":"获取商品列表（小程序端）","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"category","schema":{"type":"string","enum":["toys","gaming"]},"description":"商品分类"},{"in":"query","name":"type","schema":{"type":"string","enum":["rent","sell","both"]},"description":"交易类型"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词"},{"in":"query","name":"communityId","schema":{"type":"string"},"description":"小区ID"},{"in":"query","name":"sortBy","schema":{"type":"string","enum":["createdAt","price","viewCount","likeCount"],"default":"createdAt"},"description":"排序字段"},{"in":"query","name":"sortOrder","schema":{"type":"string","enum":["asc","desc"],"default":"desc"},"description":"排序方向"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"summary":"创建商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProductRequest"}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}}}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/recommended":{"get":{"summary":"获取推荐商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"limit","schema":{"type":"string","default":"10"},"description":"返回数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/hot":{"get":{"summary":"获取热门商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"limit","schema":{"type":"string","default":"10"},"description":"返回数量"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}}}}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}":{"get":{"summary":"获取商品详情","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}}}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"summary":"更新商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProductRequest"}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"product":{"$ref":"#/components/schemas/Product"}}}}}},"403":{"description":"无权限","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"summary":"删除商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"删除成功"},"403":{"description":"无权限","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}/like":{"post":{"summary":"收藏商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"收藏成功"},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/products/{id}/unlike":{"post":{"summary":"取消收藏商品","tags":["Products","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"取消收藏成功"},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products":{"get":{"summary":"获取商品列表","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","active","sold","rented","offline"]},"description":"商品状态"},{"in":"query","name":"category","schema":{"type":"string","enum":["toys","gaming"]},"description":"商品分类"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（商品标题或描述）"},{"in":"query","name":"ownerId","schema":{"type":"string"},"description":"卖家ID"}],"responses":{"200":{"description":"成功获取商品列表","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductListResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/{id}":{"get":{"summary":"获取商品详情","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"responses":{"200":{"description":"成功获取商品详情","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductDetailResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/{id}/approve":{"post":{"summary":"审核商品","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"商品ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductApproveRequest"}}}},"responses":{"200":{"description":"审核成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误或商品状态不正确","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证或权限不足","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"权限不足（需要审核专员或超级管理员）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"商品不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/products/batch-approve":{"post":{"summary":"批量审核商品","tags":["AdminProducts","Operation"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductBatchApproveRequest"}}}},"responses":{"200":{"description":"批量审核成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证或权限不足","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"权限不足（需要审核专员或超级管理员）","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/share":{"post":{"summary":"获取分享数据","tags":["Share","App"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","enum":["appMessage","timeline"],"description":"分享类型"},"path":{"type":"string","description":"当前页面路径"},"options":{"type":"object","description":"额外选项"}}}}}},"responses":{"200":{"description":"分享数据","content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string"},"desc":{"type":"string"},"path":{"type":"string"},"imageUrl":{"type":"string"}}}}}}}}},"/api/users/profile":{"get":{"summary":"获取用户信息","tags":["Users","App"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}}}},"put":{"summary":"更新用户信息","tags":["Users","App"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"nickname":{"type":"string"},"avatarUrl":{"type":"string"},"phone":{"type":"string"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}}}}},"/api/users/products":{"get":{"summary":"获取用户发布的商品","tags":["Users","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","active","sold","rented","offline"]},"description":"商品状态"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/Product"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}}},"/api/users/orders":{"get":{"summary":"获取用户的订单（作为买家或卖家）","tags":["Users","App"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"role","schema":{"type":"string","enum":["buyer","seller"],"default":"buyer"},"description":"角色"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"orders":{"type":"array","items":{"$ref":"#/components/schemas/Order"}},"pagination":{"$ref":"#/components/schemas/Pagination"}}}}}}}}},"/api/admin/users":{"get":{"summary":"获取用户列表","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"string","default":"1"},"description":"页码"},{"in":"query","name":"limit","schema":{"type":"string","default":"20"},"description":"每页数量"},{"in":"query","name":"role","schema":{"type":"string","enum":["user","merchant","property","admin"]},"description":"用户角色"},{"in":"query","name":"status","schema":{"type":"string","enum":["active","inactive"]},"description":"用户状态"},{"in":"query","name":"search","schema":{"type":"string"},"description":"搜索关键词（昵称/手机号/邮箱）"}],"responses":{"200":{"description":"成功获取用户列表","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserListResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/users/{id}":{"get":{"summary":"获取用户详情","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"用户ID"}],"responses":{"200":{"description":"成功获取用户详情","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDetailResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"用户不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/admin/users/{id}/status":{"put":{"summary":"更新用户状态","tags":["AdminUsers","Operation"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"用户ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserStatusUpdateRequest"}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"未认证","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"用户不存在","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"服务器错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}}},"tags":[{"name":"Auth","description":"用户认证相关接口"},{"name":"Chat","description":"小程序端聊天相关接口"},{"name":"Communities","description":"小程序端社区相关接口"},{"name":"AdminDashboard","description":"运营系统仪表盘相关接口"},{"name":"Orders","description":"小程序端订单相关接口"},{"name":"AdminOrders","description":"运营系统订单管理相关接口"},{"name":"Products","description":"小程序端商品相关接口"},{"name":"AdminProducts","description":"运营系统商品管理相关接口"},{"name":"Share","description":"分享相关接口"},{"name":"Users","description":"小程序端用户相关接口"},{"name":"AdminUsers","description":"运营系统用户管理相关接口"}]}